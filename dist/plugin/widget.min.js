(()=>{"use strict";let t,e,n,a,o,i={},c=!1;function r(t,e,n,a){fetch(t,{method:"POST",body:JSON.stringify(e),headers:n}).then((t=>t.json())).then((t=>a(t))).catch((t=>console.error("Error:",t)))}function s(t,e){let a=t?.validation;n=a?.errorMessage;const o=a?.minLength,i=a?.maxLength,c=a?.regexPattern,r=a?.placeholder?a?.placeholder:"Write hereâ€¦",s=a?.autocomplete,u=a?.type;o&&e.setAttribute("minlength",o),i&&e.setAttribute("maxlength",i),c&&e.setAttribute("pattern",c),u&&e.setAttribute("data-validator-type",u),s&&e.setAttribute("autocomplete",s),r&&e.setAttribute("placeholder",r)}function u(t){this.chatInput=document.getElementById("userText");let e=this.chatInput.scrollHeight;this.chatInput.addEventListener("input",(()=>{this.chatInput.style.height=`${e}px`,this.chatInput.style.height=`${this.chatInput.scrollHeight}px`})),this.chatInput.addEventListener("keydown",(t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),l())}));document.querySelector("#send-btn").addEventListener("click",(t=>{t.preventDefault(),l()})),this.chatbotCloseBtn=document.querySelector(".close-btn"),this.chatbotCloseBtn.addEventListener("click",(()=>{document.body.classList.remove("show-chatbot"),a.document.body.classList.remove("show-chatbot")}))}async function l(){var t=document.getElementById("userText"),e=document.querySelector(".chatbox");let a=t,o=t.value.trim();if(!o)return;let i=t.scrollHeight;t.value="",t.style.height=`${i}px`,e.appendChild(d(o,"outgoing",a,"input")),e.scrollTo(0,e.scrollHeight);let r=function(t){let e={};const n=t.getAttribute("data-validator-type"),a=t.getAttribute("minlength"),o=t.getAttribute("maxlength"),i=t.getAttribute("pattern"),c=new RegExp(i);(a||o)&&(e={minlength:a?parseInt(a):"",maxlength:o?parseInt(o):""});return{minMaxValues:e,regexObject:c,fieldValidator:n}}(t),s=await async function(t,e,n,a){if(e==v.empty(e).value)return{validation:!1,type:"empty"};if(n?.minlength&&e.length<n.minlength)return{validation:!1,type:"minLength"};if(n?.maxlength&&e.length>n.maxlength)return{validation:!1,type:"maxLength"};if(t&&a&&v[a]&&"function"==typeof v[a]){let n={value:e,regexObject:t},o=v[a](n);return{validation:!!o.value&&o.value,type:o.type}}return{validation:!0,type:""}}(r.regexObject,o,r.minMaxValues,r.fieldValidator);if(!1===s?.validation){c=!0;let t=!0;const o=d(n[s?.type],"incoming",a,"input",t);return e.appendChild(o),void e.scrollTo(0,e.scrollHeight)}!1!==s&&(c=!1,setTimeout((()=>{const t=d("Thinking ....","incoming",a,"input");e.appendChild(t),e.scrollTo(0,e.scrollHeight),h(t,o)}),600))}function d(t,e,n,a,i=!1){var c=document.getElementById("userText");const r=document.createElement("li");r.classList.add("chat",`${e}`);let s="outgoing"===e?'<p></p><span class="userLogo"></span>':'<span class="chatLogo"></span><p><span class="botAnswer"></span></p>';var u;(r.innerHTML=s,r.querySelector("p").textContent=t,sessionStorage.getItem(o))&&("click"==a?u=n?.target.getAttribute("bot_question"):"input"==a&&(u=i?n.getAttribute("pervious-ques"):n.getAttribute("bot_question")),("outgoing"==e||"incoming"==e)&&c.setAttribute("user-current-code",u));return r}function p(t){var e=document.querySelector(".chatbox");let n=t.target.value.trim();if(!n)return;const a=d(n,"outgoing",t,"click");e.appendChild(a),e.scrollTo({bottom:0,behavior:"smooth"}),setTimeout((()=>{const a=d("Thinking1 ....","incoming",t,"click");e.appendChild(a),e.scrollTo({bottom:0,behavior:"smooth"}),h(a,n)}),600)}function h(t,e){document.getElementById("userText").placeholder="Enter a message...",document.getElementById("userText").removeAttribute("disabled");let n=sessionStorage.getItem(o);g[n?"chatService":"authentication"](t,e)}i.global={init:function(){this.appInfo(),this.bootApp(),this.createContainer(),this.createHeader(),this.chatInputBox()},appInfo:function(){a=window.parent,o=a.chatBotConfig.session_key,window.sessionStorage.removeItem(o),document.addEventListener("click",u)},bootApp:function(){var t=a.chatBotConfig?.cookie;let e={module:"ChatBot",module_code:"ChatBotBoot",action:"connectBot",data:{bot:a.chatBotConfig?.bot,client_id:t||"",source:a.chatBotConfig?.messanger,page_url:a.location.href,language:a.chatBotConfig?.language,organization_code:a.chatBotConfig?.organization_code,product_code:a.chatBotConfig?.product_code}},n={"Content-Type":"application/json","api-key":a.chatBotConfig?.api_key,"api-source":"web"};r(a.chatBotConfig?.host.concat("api/v1/chatbot/boot"),e,n,(t=>{if(200==t.code){const a=t.data.question,r=t.data.question.question,u=document.querySelector(".chatbot");var e=document.createElement("ul");e.className="chatbox";var n=document.createElement("li");n.className="chat incoming";var o=document.createElement("span");o.className="chatLogo",n.appendChild(o);var i=document.createElement("p");i.textContent=r.question,n.appendChild(i),e.appendChild(n),u.appendChild(e);var c=document.getElementById("userText");c.setAttribute("bot_question",a.next_question_id),c.setAttribute("pervious-ques",a.question_id),a?.validation&&s(a,c),this.languageDropDown(t.data.language)}else{const t=document.querySelector(".chatbot"),e=document.createElement("div");e.className="body";const n=document.createElement("img");n.src=a.chatBotConfig?.boot_host+"dist/assets/images/401.png",n.alt="Chat Image",n.style.width="100%",n.style.height="66%",e.appendChild(n),t.appendChild(e)}}))},createContainer:function(){const t=document.createElement("div");t.id="chatbot-container",document.body.appendChild(t);const e=document.createElement("div");e.classList.add("chatbot"),t.appendChild(e)},createHeader:function(){const t=document.querySelector(".chatbot");var e=document.createElement("header");e.className="header";var n=document.createElement("img");n.src=a.chatBotConfig?.boot_host+"dist/assets/images/chat-avator.png",n.alt="",e.appendChild(n);var o=document.createElement("h2");o.textContent="CHAT with ShriA",e.appendChild(o);var i=document.createElement("span");i.className="close-btn material-symbols-outlined",i.textContent="close",e.appendChild(i),t.appendChild(e)},chatInputBox:function(){const t=document.querySelector(".chatbot");var e=document.createElement("div");e.className="chat-input";var n=document.createElement("textarea");n.id="userText",n.setAttribute("placeholder","Enter a message.."),n.setAttribute("required",""),e.appendChild(n),t.appendChild(e)},languageDropDown:function(t){const e=document.querySelector(".chatbot"),n=document.querySelector(".chat-input");var a=document.createElement("div");a.className="language";var o=document.createElement("button");o.className="language__action",a.appendChild(o);var i=document.createElement("ul");i.id="CurrentLang",i.className="language__list";var c=[],r=[];t.forEach((t=>{c.push(t.language_name)})),t.forEach((t=>{r.push(t.language)})),c.forEach(((t,e)=>{var n=document.createElement("li");n.value=r[e],n.id=r[e],n.setAttribute("value",r[e]),0===e&&(n.className="active"),n.textContent=t,i.appendChild(n)})),a.appendChild(i),n.appendChild(a);var s=document.createElement("span");s.id="send-btn",s.className="material-symbols-outlined",s.textContent="send",n.appendChild(s),e.appendChild(n),this.languageEvent()},languageEvent:function(){let i=document.querySelector(".language__action"),s=document.querySelector(".language__list"),u=document.querySelectorAll(".language__list li");i?.addEventListener("click",(t=>{s.classList.toggle("active"),t.stopImmediatePropagation()})),u?.forEach((i=>{i.addEventListener("click",(i=>{e=document.querySelector(".language__list li.active"),t=i.target.id,s.querySelector("li.active").classList.remove("active"),i.currentTarget.classList.add("active"),s.classList.remove("active");let u=sessionStorage.getItem(o);u&&e?.id!==t&&!1===c?function(){var t=document.getElementById("userText"),e=document.querySelector(".chatbox");let n=t,a=t.getAttribute("previous-input"),i=t.scrollHeight;t.value="",t.style.height=`${i}px`,e.scrollTo(0,e.scrollHeight),setTimeout((()=>{const t=function(t,e,n,a){var i=document.getElementById("userText");const c=document.createElement("li");c.classList.add("chat",`${e}`);let r="outgoing"===e?'<p></p><span class="userLogo"></span>':'<span class="chatLogo"></span><p><span class="botAnswer"></span></p>';c.innerHTML=r,c.querySelector("p").textContent=t;let s=sessionStorage.getItem(o);if(s){var u;"click"==a?u=n?.target.getAttribute("pervious-ques"):"input"==a&&(u=n.getAttribute("pervious-ques")),("outgoing"==e||"incoming"==e)&&i.setAttribute("user-current-code",u)}return c}("Thinking ....","incoming",n,"input");e.appendChild(t),e.scrollTo(0,e.scrollHeight),h(t,a)}),600)}():u&&e?.id!==t&&!0===c&&function(){var e=document.getElementById("userText");let i=e.getAttribute("pervious-ques"),c=e.getAttribute("previous-input"),s=sessionStorage.getItem(o),u={module:"ChatBot",module_code:"chatBotService",action:"chatErrMessage",data:{bot:a.chatBotConfig?.bot,page_url:a.location.href,qCode:i,qLanguage:t||"ENGLISH",message:c,timestamp:(new Date).getTime()}},l={"Content-Type":"application/json","api-key":a.chatBotConfig?.api_key,"api-source":"web",Authorization:"Bearer "+s};r(a.chatBotConfig?.host.concat("api/v1/chatbot/service"),u,l,(t=>{if(200===t.code){let e=t.data.validation;n=e.errorMessage}else alert("something went wrong..!")}))}()}))})),document.body.addEventListener("click",(()=>{s?.classList.remove("active")}))}},i.global.init();const g={authentication:function(e,n){var i=document.getElementById("userText"),c=e.querySelector("p"),s=a.chatBotConfig?.cookie;let u={module:"Auth",module_code:"ChatBotAuth",action:"loginAccess",data:{bot:a.chatBotConfig?.bot,client_id:s||"",page_url:a.location.href,qCode:i.getAttribute("bot_question"),qLanguage:t||"ENGLISH",message:n,timestamp:(new Date).getTime()}},l={"Content-Type":"application/json","api-key":a.chatBotConfig?.api_key,"api-source":"web"};r(a.chatBotConfig?.host.concat("api/v1/authentication"),u,l,(t=>{sessionStorage.setItem(o,t?.data?.access_token);let e=t.data.context.question_type;m[e](t,i,c,n)})),c.textContent=""},chatService:function(e,n){var i=document.getElementById("userText");let c=document.getElementById("userText").getAttribute("user-current-code");var s=e.querySelector("p");let u=sessionStorage.getItem(o),l={module:"ChatBot",module_code:"chatBotService",action:"chatService",data:{bot:a.chatBotConfig?.bot,page_url:a.location.href,qCode:c,qLanguage:t||"ENGLISH",message:n,timestamp:(new Date).getTime()}},d={"Content-Type":"application/json","api-key":a.chatBotConfig?.api_key,"api-source":"web",Authorization:"Bearer "+u};r(a.chatBotConfig?.host.concat("api/v1/chatbot/service"),l,d,(t=>{if(200===t.code){let e=t.data.context.question_type;m[e](t,i,s,n,u)}else alert("something went wrong..!")})),s.textContent=""}},m={inputBox:function(t,e,n,a,o=""){const i=t.data.context,c=t.data.context.question;e.setAttribute("bot_question",i.next_question_id),e.setAttribute("pervious-ques",i.question_id),e.setAttribute("previous-input",a),o?e.removeAttribute("authques"):e.setAttribute("authques","yes"),i?.validation&&s(i,e);var r=document.createTextNode(c.question);n.appendChild(r)},radio:function(t,e,n,a,o=""){const i=t.data.context,c=t.data.context.question,r=t.data.context.options;var s=document.createElement("p");s.classList.add("designText");var u=document.createTextNode(c.question);s.appendChild(u),n.appendChild(s),r.forEach((t=>{var c=document.createElement("button");c.classList.add("selectOptBtn"),c.setAttribute("bot_question",t.next_question_id),c.setAttribute("value",t.question),e.setAttribute("previous-input",a),e.setAttribute("pervious-ques",i.question_id),o?e.removeAttribute("authques"):e.setAttribute("authques","yes");var r=document.createTextNode(t.question);c.appendChild(r),n.appendChild(c),c.addEventListener("click",p)})),document.getElementById("userText").placeholder="Please select options",document.getElementById("userText").setAttribute("disabled",!0)}},v={empty:function(t){return{value:""==t,type:"required"}},alphaValidation:function(t){return{value:t.regexObject.test(t.value),type:"alphaValidation"}},numericValidation:function(t){return{value:t.regexObject.test(t.value),type:"numericValidation"}},alphaNumericValidation:function(t){return{value:t.regexObject.test(t.value),type:"alphaNumericValidation"}},emailValidation:function(t){return{value:t.regexObject.test(t.value),type:"emailValidation"}},panValidation:function(t){return{value:t.regexObject.test(t.value),type:"panValidation"}}}})();
//# sourceMappingURL=widget.min.js.map